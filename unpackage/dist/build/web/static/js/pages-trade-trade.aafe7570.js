(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-trade-trade"],{"16ca":function(e,t,n){"use strict";n("6a54");var a=n("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("7a76"),n("c9b5"),n("d4b5"),n("c223"),n("80e3"),n("4db2"),n("bf0f"),n("c976"),n("4d8f"),n("7b97"),n("668a"),n("c5b7"),n("8ff5"),n("2378"),n("641a"),n("64e0"),n("cce3"),n("efba"),n("d009"),n("bd7d"),n("7edd"),n("d798"),n("f547"),n("5e54"),n("b60a"),n("8c18"),n("12973"),n("f991"),n("198e"),n("8557"),n("63b1"),n("1954"),n("1cf1"),n("fd3c"),n("bd06"),n("aa9c"),n("795c");var i=a(n("c5ee")),o={data:function(){return{symbol:"btcusdt",interval:"1min",klineData:[],_from:0,_to:0}},onLoad:function(){window.addEventListener("message",(function(e){console.log("接收到的消息:",e.data)})),this.initWebSocket(),this.getTimestampWithOffset("minute",100)},watch:{klineData:function(e,t){console.log("klineData changed:",e),this.sendMessage()}},methods:{getTimestampWithOffset:function(e,t){var n,a=Date.now();switch(e){case"minute":case"minutes":n=60*t*1e3;break;case"hour":case"hours":n=60*t*60*1e3;break;case"second":case"seconds":n=1e3*t;break;case"day":case"days":n=1e3*t;break;default:throw new Error('Unsupported unit. Use "seconds", "minutes", or "hours".')}var i=a-n;this._to=a/1e3,this._from=i/1e3},initWebSocket:function(){var e=this,t=this;this.ws=uni.connectSocket({url:"wss://api.huobi.pro/ws",complete:function(){}}),this.ws.onOpen((function(){console.log("WebSocket connected"),e.ws.send({data:JSON.stringify({req:"market.".concat(e.symbol,".kline.").concat(e.interval),id:e.symbol,from:e._from,to:e._to})}),e.ws.send({data:JSON.stringify({sub:"market.".concat(e.symbol,".kline.").concat(e.interval),id:e.symbol})})})),this.ws.onMessage((function(n){if(n.data instanceof ArrayBuffer){var a=i.default.inflate(new Uint8Array(n.data),{to:"string"}),o=JSON.parse(a);if(console.log(o),o.ping&&e.ws.send({data:JSON.stringify({pong:Date.now()})}),o.rep&&o.data.map((function(e){var n=t.getTime(1e3*e.id),a=[n,e.open,e.high,e.low,e.close,e.vol],i=t.klineData.findIndex((function(e){return e[0]===n}));-1!==i?t.klineData[i]=a:t.klineData.push(a),t.klineData.length>900&&t.klineData.shift()})),o.tick){var s=t.getTime(1e3*o.tick.id),c=[s,o.tick.open,o.tick.high,o.tick.low,o.tick.close,o.tick.vol],r=e.klineData.findIndex((function(e){return e[0]===s}));-1!==r?e.klineData[r]=c:e.klineData.push(c),e.klineData.length>900&&e.klineData.shift(),console.log(e.klineData[0]),e.sendMessage()}}})),this.ws.onError((function(e){console.error("WebSocket error:",e)})),this.ws.onClose((function(){console.log("WebSocket disconnected")}))},getTime:function(e){var t=e,n=new Date(t),a=n.getFullYear(),i=String(n.getMonth()+1).padStart(2,"0"),o=String(n.getDate()).padStart(2,"0"),s=String(n.getHours()).padStart(2,"0"),c=String(n.getMinutes()).padStart(2,"0"),r=String(n.getSeconds()).padStart(2,"0");return"".concat(a,"-").concat(i,"-").concat(o," ").concat(s,":").concat(c,":").concat(r)},sendMessage:function(){var e=this.$refs.webview;if(console.log(e),e){var t=e.iframe;t&&t.contentWindow?t.contentWindow.postMessage({type:"update_kline",data:this.klineData},"*"):console.error("Webview 内部未找到 iframe")}else console.error("Webview 未找到")},updateChart:function(e){console.log("99990000"),console.log(uni.webView),uni.webView.postMessage({data:{key:"value",action:"sendMessage"}})}}};t.default=o},4941:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){}));var a=function(){var e=this.$createElement,t=this._self._c||e;return t("v-uni-view",{},[t("v-uni-web-view",{ref:"webview",attrs:{src:"/hybrid/html/local.html"}})],1)},i=[]},"73e1":function(e,t,n){"use strict";var a=n("29d8");e.exports=/Version\/10(?:\.\d+){1,2}(?: [\w./]+)?(?: Mobile\/\w+)? Safari\//.test(a)},"795c":function(e,t,n){"use strict";var a=n("8bdb"),i=n("db04").start,o=n("73e1");a({target:"String",proto:!0,forced:o},{padStart:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}})},8828:function(e,t,n){"use strict";n.r(t);var a=n("4941"),i=n("be0b");for(var o in i)["default"].indexOf(o)<0&&function(e){n.d(t,e,(function(){return i[e]}))}(o);var s=n("828b"),c=Object(s["a"])(i["default"],a["b"],a["c"],!1,null,"79a71cb8",null,!1,a["a"],void 0);t["default"]=c.exports},be0b:function(e,t,n){"use strict";n.r(t);var a=n("16ca"),i=n.n(a);for(var o in a)["default"].indexOf(o)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(o);t["default"]=i.a},db04:function(e,t,n){"use strict";var a=n("bb80"),i=n("c435"),o=n("9e70"),s=n("f298"),c=n("862c"),r=a(s),d=a("".slice),u=Math.ceil,l=function(e){return function(t,n,a){var s,l,f=o(c(t)),b=i(n),g=f.length,h=void 0===a?" ":o(a);return b<=g||""===h?f:(s=b-g,l=r(h,u(s/h.length)),l.length>s&&(l=d(l,0,s)),e?f+l:l+f)}};e.exports={start:l(!1),end:l(!0)}}}]);